{"ast":null,"code":"import _objectSpread from\"/home/shirin/Desktop/Frontend Assessment- Hacker Rank Clone /my-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"/home/shirin/Desktop/Frontend Assessment- Hacker Rank Clone /my-app/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/shirin/Desktop/Frontend Assessment- Hacker Rank Clone /my-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/shirin/Desktop/Frontend Assessment- Hacker Rank Clone /my-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useContext,useEffect,useReducer}from\"react\";import searchReducer from\"./searchReducer.jsx\";import{jsx as _jsx}from\"react/jsx-runtime\";var initialSearchState={loading:true,query:\"\",nbPages:0,page:0,hits:[],content:\"story\",popularity:\"popularity\",API:\"http://hn.algolia.com/api/v1/search?\",duration:\"-1\"};//debouncing\nvar AppSearchContext=/*#__PURE__*/React.createContext();var AppSearchProvider=function AppSearchProvider(_ref){var children=_ref.children;var _useReducer=useReducer(searchReducer,initialSearchState),_useReducer2=_slicedToArray(_useReducer,2),state=_useReducer2[0],dispatch=_useReducer2[1];var _React$useState=React.useState(initialSearchState),_React$useState2=_slicedToArray(_React$useState,2),data=_React$useState2[0],setData=_React$useState2[1];var fetchSearchAPIData=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(url){var res,_data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dispatch({type:\"SET_LOADING\"});_context.prev=1;_context.next=4;return fetch(url);case 4:res=_context.sent;_context.next=7;return res.json();case 7:_data=_context.sent;dispatch({type:\"GET_NEWS\",payload:{hits:_data.hits,nbPages:_data.nbPages}});_context.next=14;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](1);console.log(_context.t0);case 14:case\"end\":return _context.stop();}}},_callee,null,[[1,11]]);}));return function fetchSearchAPIData(_x){return _ref2.apply(this,arguments);};}();var searchText=function searchText(searchQuery){// console.log(\"-------------------\");\n// console.log(\"in searchText\");\n// console.log(searchQuery);\n// console.log(\"-------------------\");\n// console.log(initialSearchState.query);\n// console.log(data);\ndispatch({type:\"SEARCH_TEXT\",payload:searchQuery});// setData({\n// ...data,\n// query: searchQuery,\n// });\n// console.log(initialSearchState.query);\n};var selectContent=function selectContent(content){// console.log(\"-------------------\");\n// console.log(\"in selectContent\");\n// console.log(content);\n// console.log(\"-------------------\");\ndispatch({type:\"SELECT_CONTENT\",payload:content});// initialSearchState.content= content;\n};// const getNextPage = () => {\n//     dispatch({type: \"NEXT_PAGE\",});\n// };\n// const getPrevPage = () => {\n//     dispatch({type: \"PREV_PAGE\",});\n// };\nvar selectPopularity=function selectPopularity(selectedValue){dispatch({type:\"SELECT_POPULARITY\",payload:selectedValue});};var selectDuration=function selectDuration(duration){dispatch({type:\"SELECT_DURATION\",payload:duration});};useEffect(function(){// console.log(\n//   `${state.API}query=${state.query}&tags=${state.content}&page=${state.page}`\n// );\nconsole.log(state.content);if(state.query==null)fetchSearchAPIData(\"\".concat(state.API,\"tags=\").concat(state.content,\"&page=\").concat(state.page,\"&hitsPerPage=30&numericFilters=created_at_i>\").concat(state.duration));else fetchSearchAPIData(\"\".concat(state.API,\"query=\").concat(state.query,\"&tags=\").concat(state.content,\"&page=\").concat(state.page,\"&hitsPerPage=30&numericFilters=created_at_i>\").concat(state.duration));},[state.page,state.query,state.API,state.duration,state.content]);return/*#__PURE__*/_jsx(AppSearchContext.Provider,{value:_objectSpread(_objectSpread({},state),{},{searchText:searchText,selectContent:selectContent,selectPopularity:selectPopularity,selectDuration:selectDuration}),children:children});};var useSearchGlobalContext=function useSearchGlobalContext(){return useContext(AppSearchContext);};export{useSearchGlobalContext,AppSearchProvider};","map":{"version":3,"names":["React","useContext","useEffect","useReducer","searchReducer","initialSearchState","loading","query","nbPages","page","hits","content","popularity","API","duration","AppSearchContext","createContext","AppSearchProvider","children","state","dispatch","useState","data","setData","fetchSearchAPIData","url","type","fetch","res","json","payload","console","log","searchText","searchQuery","selectContent","selectPopularity","selectedValue","selectDuration","useSearchGlobalContext"],"sources":["/home/shirin/Desktop/Frontend Assessment- Hacker Rank Clone /my-app/src/components/searchContext.jsx"],"sourcesContent":["import React, { useContext, useEffect, useReducer } from \"react\";\nimport searchReducer from \"./searchReducer.jsx\";\n\nconst initialSearchState = {\n  loading: true,\n  query: \"\",\n  nbPages: 0,\n  page: 0,\n  hits: [],\n  content: \"story\",\n  popularity: \"popularity\",\n  API: \"http://hn.algolia.com/api/v1/search?\",\n  duration: \"-1\",\n};\n//debouncing\nconst AppSearchContext = React.createContext();\n\nconst AppSearchProvider = ({ children }) => {\n   const [state, dispatch] = useReducer(searchReducer, initialSearchState);\n    const [data, setData] = React.useState(initialSearchState);\n  const fetchSearchAPIData = async (url) => {\n    dispatch({ type: \"SET_LOADING\" });\n\n    try {\n      const res = await fetch(url);\n      const data = await res.json();\n\n      dispatch({\n        type: \"GET_NEWS\",\n        payload: {\n          hits: data.hits,\n          nbPages: data.nbPages,\n        },\n      });\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  const searchText = (searchQuery) => {\n    // console.log(\"-------------------\");\n    // console.log(\"in searchText\");\n    // console.log(searchQuery);\n    // console.log(\"-------------------\");\n    \n    // console.log(initialSearchState.query);\n    // console.log(data);\n\n    dispatch({ type: \"SEARCH_TEXT\", payload: searchQuery });\n    // setData({\n        // ...data,\n        // query: searchQuery,\n    // });\n    // console.log(initialSearchState.query);\n  };\n\n  const selectContent = (content) => {\n    // console.log(\"-------------------\");\n    // console.log(\"in selectContent\");\n    // console.log(content);\n    // console.log(\"-------------------\");\n    dispatch({ type: \"SELECT_CONTENT\", payload: content });\n    // initialSearchState.content= content;\n  };\n\n\n  // const getNextPage = () => {\n  //     dispatch({type: \"NEXT_PAGE\",});\n  // };\n\n  // const getPrevPage = () => {\n  //     dispatch({type: \"PREV_PAGE\",});\n  // };\n\n  const selectPopularity = (selectedValue) => {\n    dispatch({ type: \"SELECT_POPULARITY\", payload: selectedValue });\n  };\n\n  const selectDuration = (duration) => {\n    dispatch({ type: \"SELECT_DURATION\", payload: duration });\n  };\n\n  \n\n  useEffect(() => {\n    // console.log(\n    //   `${state.API}query=${state.query}&tags=${state.content}&page=${state.page}`\n    // );\n    console.log(state.content);\n    if (state.query == null)\n      fetchSearchAPIData(\n        `${state.API}tags=${state.content}&page=${state.page}&hitsPerPage=30&numericFilters=created_at_i>${state.duration}`\n      );\n    else\n      fetchSearchAPIData(\n        `${state.API}query=${state.query}&tags=${state.content}&page=${state.page}&hitsPerPage=30&numericFilters=created_at_i>${state.duration}`\n      );\n  }, [state.page, state.query, state.API, state.duration, state.content]);\n\n  return (\n    <AppSearchContext.Provider\n      value={{\n        ...state,\n        searchText,\n        selectContent,\n        selectPopularity,\n        selectDuration,\n      }}\n    >\n      {children}\n    </AppSearchContext.Provider>\n  );\n};\n\nconst useSearchGlobalContext = () => {\n  return useContext(AppSearchContext);\n};\n\nexport { useSearchGlobalContext, AppSearchProvider };\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}